name: Kur Guncelle Cron

on:
  schedule:
    - cron: "0 5 * * *"    # 09:00 TR
    - cron: "0 9 * * *"   # 13:00 TR
  workflow_dispatch:

jobs:
  update-kur:
    runs-on: ubuntu-latest

    steps:
      - name: Baslangic logu
        run: |
          echo "=============================="
          echo "‚è∞ CRON BASLADI"
          echo "Tarih (UTC): $(date)"
          echo "=============================="

      - name: Render uyandir
        run: |
          echo "‚òÄÔ∏è Render uyandiriliyor..."
          curl -s https://kur-guncelle-api.onrender.com || true
          sleep 40

      - name: Kur guncelle
        run: |
          echo "üí∏ Kur guncelle istegi atiliyor"
          curl -v -X POST https://kur-guncelle-api.onrender.com/kur-guncelle \
            -H "x-api-key: ${{ secrets.API_KEY }}"

      - name: Bitis logu
        run: |
          echo "=============================="
          echo "‚úÖ CRON BITTI"
          echo "Tarih (UTC): $(date)"
          echo "=============================="
